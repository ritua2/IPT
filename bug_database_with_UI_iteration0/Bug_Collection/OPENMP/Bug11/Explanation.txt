Reduction is used incorrectly. 
In details:

``````````````````````````````
#pragma omp parallel for reduction(+: sum)
for (int i = 0; i < DATA_MAG; i++)
{
    sum += H[i];

    LUT[i] = sum * scale_factor;
}
``````````````````````````````

The reduced variable `sum` is used to calculate `LUT[i]` .

