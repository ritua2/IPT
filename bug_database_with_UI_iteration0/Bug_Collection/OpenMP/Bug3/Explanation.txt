Error because of incorrect assignment for variale storage attributes

The loop index is actually not shared, each mpi thread needs to have their own index