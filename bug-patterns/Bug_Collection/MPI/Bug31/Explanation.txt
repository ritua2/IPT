Error: incorrect choice of collectives for handling data distribution

In this case, 2 elements are updated in one iteration except for the last iteration.

The buggy version does not handle this case.